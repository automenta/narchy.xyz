<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DeductiveChainTest.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">OpenNARS Logic Reasoner</a> &gt; <a href="index.source.html" class="el_package">nars.util.meter.experiment</a> &gt; <span class="el_source">DeductiveChainTest.java</span></div><h1>DeductiveChainTest.java</h1><pre class="source lang-java linenums">package nars.util.meter.experiment;

import nars.$;
import nars.Global;
import nars.NAR;
import nars.nar.Default;
import nars.term.atom.Atom;
import nars.term.compound.Compound;
import nars.util.meter.TestNAR;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.annotations.Nullable;

/**
 * Created by me on 8/25/15.
 */
public class DeductiveChainTest extends TestNAR {

    @NotNull
    public final Compound q;
    @NotNull
    public final Compound[] beliefs;

    @FunctionalInterface
    public interface IndexedStatementBuilder {
        @NotNull
        Compound apply(int x, int y);
    }

    @Nullable
<span class="fc" id="L30">    public static final IndexedStatementBuilder inh = (int x, int y) -&gt;</span>
<span class="fc" id="L31">            (Compound)$.inh(a(x), a(y));</span>
    @Nullable
<span class="fc" id="L33">    public static final IndexedStatementBuilder sim = (int x, int y) -&gt;</span>
<span class="nc" id="L34">            (Compound)$.sim(a(x), a(y));</span>
    @Nullable
<span class="fc" id="L36">    public static final IndexedStatementBuilder impl = (int x, int y) -&gt;</span>
<span class="nc" id="L37">            (Compound)$.impl(a(x), a(y));</span>
    @Nullable
<span class="fc" id="L39">    public static final IndexedStatementBuilder equiv = (int x, int y) -&gt;</span>
<span class="nc" id="L40">            (Compound)$.equiv(a(x), a(y));</span>

    public DeductiveChainTest(@NotNull NAR n, int length, int timeLimit, @NotNull IndexedStatementBuilder b) {
<span class="fc" id="L43">        super(n);</span>

<span class="fc" id="L45">        beliefs = new Compound[length];</span>
<span class="fc bfc" id="L46" title="All 2 branches covered.">        for (int x = 0; x &lt; length; x++) {</span>
<span class="fc" id="L47">            beliefs[x] = b.apply(x, x+1);</span>
        }

<span class="fc" id="L50">        q = b.apply(0, length);</span>

<span class="fc bfc" id="L52" title="All 2 branches covered.">        for (Compound belief : beliefs) {</span>
<span class="fc" id="L53">            n.believe(belief);</span>
        }
<span class="fc" id="L55">        n.ask( q );</span>

<span class="fc" id="L57">        mustBelieve(timeLimit, q.toString(), 1f, 1f, 0.01f, 1f);</span>

<span class="fc" id="L59">    }</span>


    @NotNull
    public static Atom a(int i) {
<span class="fc" id="L64">        return Atom.the((byte)('a' + i));</span>
    }


    public static void main(String[] args) {

<span class="nc" id="L70">        Global.DEBUG = false;</span>

<span class="nc bnc" id="L72" title="All 2 branches missed.">        for (int length = 3; length &lt; 10; length++) {</span>
<span class="nc" id="L73">            test(new Default(1024,1,1,3).nal(6), length, 1000*length, inh);</span>
        }
<span class="nc" id="L75">    }</span>

    static void test(@NotNull NAR n, int chainLen, int cycles, @NotNull IndexedStatementBuilder statementType) {


<span class="nc" id="L80">        DeductiveChainTest test = new DeductiveChainTest(n, chainLen, cycles, statementType) {</span>
//            @Override
//            public TestNAR mustBelieve(long withinCycles, String term, float confidence, float x, float y, float z) throws InvalidInputException {
//                return this;
//            }
        };

<span class="nc" id="L87">        System.out.print(DeductiveChainTest.class.getSimpleName() + &quot; test: &quot;</span>
                + test.q + &quot;?\t&quot;);

<span class="nc" id="L90">        final long start = System.currentTimeMillis();</span>

//        new AnswerReaction(n) {
//
//            @Override
//            public void onSolution(Task belief) {
//                if (belief.getTerm().equals(test.q)) {
//                    System.out.println(belief + &quot; &quot; + timestamp(start) + &quot; &quot; +
//                            n.concepts().size() + &quot; concepts&quot;);
//                    System.out.println(belief.getExplanation());
//                    System.out.println();
//                }
//            }
//        };


<span class="nc" id="L106">        test.run(false);</span>


        //n.stdout();
        //n.frame(5000);

<span class="nc" id="L112">        int nc = ((Default) n).core.active.size();</span>
<span class="nc" id="L113">        String ts = timestamp(start);</span>
<span class="nc" id="L114">        long time = n.time();</span>

        //n.stdout();
        //n.frame(55); //to print the ending

        //while (true) {

<span class="nc" id="L121">        Report r = test.getReport();</span>

<span class="nc" id="L123">        System.out.println(</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">                (r.isSuccess() ? &quot;OK&quot; : &quot;ERR&quot;) +</span>
                &quot;\t@&quot; + time + &quot; (&quot; + ts + &quot;ms) &quot; +
                nc + 'C');


        //TextOutput.out(n).setOutputPriorityMin(0.85f);

//        while (true) {
//
//            n.run(500);
//            //sleep(20);
//
//            if (n.time() % printEvery == 0) {
//                System.out.println(n.time() + &quot; &quot; + timestamp(start) + &quot; &quot; +
//                        n.memory().size());
//            }
//        }


<span class="nc" id="L143">    }</span>

    @NotNull
    private static String timestamp(long start) {
<span class="nc" id="L147">        return (System.currentTimeMillis() - start) + &quot; ms&quot;;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>